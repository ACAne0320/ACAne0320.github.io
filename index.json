[{"content":"é¥¥è’æœåŠ¡å™¨é…ç½® æœºå™¨é…ç½® ä¸»æœºé…ç½® ç³»ç»Ÿç‰ˆæœ¬ï¼šWindows 11 23H2\næœåŠ¡å™¨ è…¾è®¯äº‘è½»é‡çº§æœåŠ¡å™¨\né…ç½®ï¼š2C4G\nå­˜å‚¨ï¼šSSDäº‘ç¡¬ç›˜ 70GB\næµé‡ï¼š600GB/æœˆï¼ˆå¸¦å®½ï¼š6Mbpsï¼‰\né•œåƒï¼šUbuntu22.04-Docker26\nä¸€ã€ä¸‹è½½SteamCMD 1ã€åˆ›å»ºæ–°ç”¨æˆ· åˆ›å»ºä¸€ä¸ªåä¸º steam çš„ç”¨æˆ·å¸æˆ·ä»¥å®‰å…¨åœ°è¿è¡Œ SteamCMDï¼Œå¹¶å°†å…¶ä¸æ“ä½œç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†éš”ç¦»ã€‚ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•æ—¶è¯·å‹¿è¿è¡Œ steamcmdâ€”â€”è¿™æ ·åšä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚\n1.ä»¥ root ç”¨æˆ·èº«ä»½åˆ›å»º steam ç”¨æˆ·ï¼š useradd -m steam or sudo useradd -m steam 2.è®¾ç½®å¯†ç  sudo passwd steam 3.åˆ‡æ¢åˆ°steamç”¨æˆ· su - steam çœ‹åˆ° $ æç¤ºç¬¦å°±ç®—åˆ‡æ¢æˆåŠŸ\nubuntu@VM-8-7-ubuntu:~$ su - steam Password: $ $ ä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®è®¤å½“å‰ç”¨æˆ·ï¼š\nwhoami è¾“å‡ºåº”ä¸ºï¼š\nsteam ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç¡®è®¤å½“å‰ç›®å½•ï¼š\npwd è¾“å‡ºåº”ä¸ºï¼š\n/home/steam 4.ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ä¸º steam ç”¨æˆ·èµ‹äºˆ sudo æƒé™ 1.åˆ‡æ¢å›ç®¡ç†å‘˜è´¦æˆ·ï¼ˆå¦‚ ubuntu ç”¨æˆ·ï¼‰ï¼š\nexit 2.ç¡®è®¤å½“å‰ç”¨æˆ·æœ‰ sudo æƒé™ï¼š è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ï¼š\nsudo whoami å¦‚æœè¾“å‡ºä¸º rootï¼Œè¯´æ˜å½“å‰ç”¨æˆ·æœ‰æƒé™ã€‚\n3.å°† steam ç”¨æˆ·æ·»åŠ åˆ° sudo ç»„ï¼š\nsudo usermod -aG sudo steam -aG å‚æ•°è¡¨ç¤ºå°†ç”¨æˆ·æ·»åŠ åˆ°ä¸€ä¸ªé™„åŠ ç»„ï¼ˆè¿™é‡Œæ˜¯ sudoï¼‰ã€‚\n4.éªŒè¯ steam ç”¨æˆ·çš„ sudo æƒé™ï¼š åˆ‡æ¢å› steam ç”¨æˆ·ï¼š\nsu - steam ç„¶åæµ‹è¯•ï¼š\nsudo whoami å¦‚æœè¾“å‡ºä¸º rootï¼Œåˆ™æƒé™å·²æˆåŠŸèµ‹äºˆã€‚\n2ã€ä¸‹è½½SteamCMD æ–¹æ³•1ï¼šå®‰è£…æ¥è‡ªè½¯ä»¶ä»“åº“çš„è½¯ä»¶åŒ… å»ºè®®ä»æ‚¨çš„åˆ†å‘è½¯ä»¶ä»“åº“å®‰è£… SteamCMD è½¯ä»¶åŒ…ï¼ˆå¦‚æœæœ‰ï¼‰ï¼š Ubuntu/Debian\nsudo apt install steamcmd **æ³¨æ„ï¼š**å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯64ä½è®¡ç®—æœºï¼Œåˆ™éœ€è¦æ·»åŠ  multiverse\nsudo add-apt-repository multiverse sudo dpkg --add-architecture i386 sudo apt update sudo apt install lib32gcc1 steamcmd RedHat/CentOS\nyum install steamcmd Arch Linux\ngit clone https://aur.archlinux.org/steamcmd.git cd steamcmd makepkg -si é“¾æ¥ steamcmd å¯æ‰§è¡Œæ–‡ä»¶ï¼š ln -s /usr/games/steamcmd steamcmd æ–¹æ³•2ï¼šæ‰‹åŠ¨å®‰è£… åœ¨å¼€å§‹ä¹‹å‰ï¼Œæ‚¨å¿…é¡»å…ˆå®‰è£…è¿è¡Œ SteamCMD æ‰€éœ€çš„ä¾èµ–é¡¹ï¼š Ubuntu/Debian 64-Bit\nsudo apt-get install lib32gcc1 RedHat/CentOS\nyum install glibc libstdc++ RedHat/CentOS 64-Bit\nyum install glibc.i686 libstdc++.i686 ä»¥ root ç”¨æˆ·èº«ä»½å‡çº§è‡³ steam ç”¨æˆ·ï¼š su - steam å¦‚æœæ‚¨ä¸æ˜¯ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•ï¼Œè€Œæ˜¯ä½¿ç”¨sudoæ¥è¡Œä½¿ç®¡ç†æƒé™ï¼Œè¯·ä»¥å¦‚ä¸‹æ‰€ç¤ºæ¥å‡çº§è‡³ steam ç”¨æˆ·ï¼š\nsudo -iu steam ä¸º SteamCMD åˆ›å»ºç›®å½•å¹¶åˆ‡æ¢è‡³è¯¥ç›®å½•ã€‚ mkdir ~/Steam \u0026amp;\u0026amp; cd ~/Steam ä¸‹è½½å¹¶è§£å‹ç¼©é€‚ç”¨äº Linux çš„ SteamCMDã€‚ curl -sqL \u0026#34;https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz\u0026#34; | tar zxvf - ä¸­å›½å†…åœ°ç”¨æˆ·å¯ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»¥ä½¿ç”¨å†…åœ°èŠ‚ç‚¹ï¼š\ncurl -sqL \u0026#34;https://media.st.dl.bscstorage.net/client/installer/steamcmd_linux.tar.gz\u0026#34; | tar zxvf - å®‰è£…tmux å’Œ/æˆ– screen ä»¥ç®€åŒ–æœåŠ¡å™¨ç®¡ç† sudo apt-get install tmux screen -y; äºŒã€è¿è¡Œ SteamCMD Linux/macOS æ‰“å¼€ä¸€ä¸ªç»ˆç«¯å¹¶å¯åŠ¨ SteamCMD.\nå¦‚æœæ‚¨æ˜¯é€šè¿‡è½¯ä»¶ä»“åº“ä¸­çš„è½¯ä»¶åŒ…å®‰è£…çš„ï¼š\ncd ~ steamcmd å¦‚æœæ‚¨æ˜¯æ‰‹åŠ¨å®‰è£…çš„ï¼š\ncd ~/Steam ./steamcmd.sh ä¸‰ã€ç™»å½• SteamCMD æ–¹æ³•1ï¼šåŒ¿åç™»å½• ä¸‹è½½å¤§å¤šæ•°æ¸¸æˆæœåŠ¡ç«¯ï¼Œä½ å¯ä»¥é€‰æ‹©åŒ¿åç™»å½•ã€‚\nlogin anonymous æ–¹æ³•2ï¼šä½¿ç”¨ Steam å¸æˆ·ç™»å½• ä¸€äº›æœåŠ¡ç«¯éœ€è¦ä½ ä½¿ç”¨ä¸€ä¸ª Steam å¸æˆ·æ¥ç™»å½•ã€‚\næ³¨æ„ï¼š\nä¸ºäº†å®‰å…¨èµ·è§å»ºè®®æ‚¨åˆ›å»ºä¸€ä¸ªæœåŠ¡ç«¯ä¸“ç”¨çš„ Steam å¸æˆ·ã€‚\nä¸€ä¸ªç”¨æˆ·åŒæ—¶åªèƒ½åœ¨ä¸€å¤„ç™»å½•ï¼ˆæ— è®ºæ˜¯åœ¨å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯è¿˜æ˜¯åœ¨ SteamCMD ç™»å½•ï¼‰ã€‚\nlogin \u0026lt;ç”¨æˆ·å\u0026gt; ä¸‹ä¸€æ­¥è¯·è¾“å…¥æ‚¨çš„å¯†ç ã€‚\nå¦‚æœ Steam ä»¤ç‰Œå·²ç»åœ¨ç”¨æˆ·å¸æˆ·ä¸Šæ¿€æ´»ï¼ŒæŸ¥çœ‹ä½ ç”µå­é‚®ç®±ä¸­çš„ Steam ä»¤ç‰ŒéªŒè¯ç å¹¶è¾“å…¥å®ƒã€‚è¿™ä»…ä»…åªæ˜¯ç¬¬ä¸€æ¬¡ç™»å½•æ—¶éœ€è¦ï¼ˆä»¥åŠå½“ä½ åˆ é™¤äº† SteamCMD ç”¨äºå­˜å‚¨ç™»å½•ä¿¡æ¯æ–‡ä»¶çš„æ—¶å€™ï¼‰ã€‚\nå¦‚æœä½ å·²ç»æˆåŠŸç™»å½•äº†ä½ çš„å¸æˆ·ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ä¸€æ¡æ¶ˆæ¯ã€‚\nå››ã€ä¸‹è½½é¥¥è’è”æœºç‰ˆ æ‰“å¼€ SteamCMD å¹¶ç™»å½•å®ƒã€‚\nè®¾ç½®ä½ çš„åº”ç”¨å®‰è£…ç›®å½•ï¼ˆæ³¨æ„ï¼šåœ¨ Linux/macOS ä¸‹ä½¿ç”¨æ­£æ–œæ /ï¼Œåœ¨Windows ä¸‹ä½¿ç”¨åæ–œæ \\ï¼‰ã€‚\nforce_install_dir \u0026lt;è·¯å¾„\u0026gt; ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…é¥¥è’è”æœºç‰ˆçš„åœ¨å½“å‰ç›®å½•ä¸‹ï¼š\nforce_install_dir ./dontstarvetogether_dedicated_server äº”ã€åˆ›å»ºæœåŠ¡å™¨å­˜æ¡£ 1ã€åˆ›å»ºåœ°å›¾ åœ¨Windowsä¸Šå…ˆåˆ›å»ºåœ°å›¾ï¼Œç„¶åæ‰¾åˆ°åœ°å›¾æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­ã€‚\nåœ¨Windowsä¸Šæ‰“å¼€é¥¥è’è”æœºç‰ˆï¼Œåœ¨é€‰å•ç•Œé¢ç‚¹å‡»åˆ›å»ºæ¸¸æˆå¯¹è”æœºéœ€è¦åˆ›å»ºçš„ä¸–ç•Œè¿›è¡Œé…ç½®ï¼ŒæœåŠ¡å™¨æ¨¡å¼é€‰æ‹©å…¬å…±ï¼Œé…ç½®å¥½å¯†ç ï¼Œé€‰æ‹©æœåŠ¡å™¨è®¾ç½®ï¼Œå¹¶å‹¾é€‰è¦ä½¿ç”¨çš„MODã€‚\né…ç½®å®Œæˆåï¼Œç‚¹å‡»â€œç”Ÿæˆä¸–ç•Œâ€ï¼Œç­‰å¾…ä¸–ç•Œåˆ›å»ºå®Œæˆï¼Œåœ¨è¿›å…¥é€‰æ‹©äººç‰©ç•Œé¢åï¼Œå°±å¯ä»¥é€€å‡ºäº†ã€‚\n2ã€æ‹·è´åœ°å›¾ åœ¨æœåŠ¡å™¨ä¸­åˆ›å»ºå­˜æ¡£çš„å­˜æ”¾æ–‡ä»¶å¤¹ã€‚\nmkdir -p ~/.klei/DoNotStarveTogether/Cluster_1 åœ¨Windowsä¸­çš„C:\\Users\\{user_name}\\Documents\\Klei\\DoNotStarveTogetheræ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰¾åˆ°ä½ åˆšæ‰åˆ›å»ºçš„å­˜æ¡£ï¼Œå°†æ‰€æœ‰å†…å®¹ä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨ä¸­çš„/.klei/DoNotStarveTogether/Cluster_1æ–‡ä»¶å¤¹é‡Œã€‚\n3ã€åˆ›å»ºæœåŠ¡å™¨token è¿›å…¥ç§‘é›·ç”¨æˆ·ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»å¯¼èˆªæ ä¸­çš„æ¸¸æˆï¼Œçœ‹åˆ°é¥¥è’åç‚¹å‡»ã€Šé¥¥è’ï¼šè”æœºç‰ˆã€‹çš„æ¸¸æˆæœåŠ¡å™¨ï¼Œè¾“å…¥åç§°ç‚¹å‡»æ–°å¢æœåŠ¡å™¨ï¼Œå¾—åˆ°æœåŠ¡å™¨tokenã€‚\nåœ¨æœåŠ¡å™¨çš„Cluster_1ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶cluster_token.txt, å°†æœåŠ¡å™¨tokenä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚\nvim cluster_token.txt // æŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼ // å°†ç”Ÿæˆçš„ pds-g å¼€å¤´çš„ token å¤åˆ¶è¿›è¯¥æ–‡ä»¶ // è¾“å…¥:wqä¿å­˜ 4ã€æ·»åŠ ç®¡ç†å‘˜æƒé™ è¿›å…¥ç§‘é›·ç”¨æˆ·ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»å¯¼èˆªæ ä¸­çš„ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥çœ‹è‡ªå·±çš„Kleiç”¨æˆ·ID\nåŒæ ·çš„åˆ›å»ºç®¡ç†å‘˜æƒé™æ–‡ä»¶ï¼Œå¤åˆ¶kleiIDåˆ°æ–‡ä»¶ä¸­\nvim adminlist.txt // æŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼ // å°† Klei ID å¤åˆ¶è¿›è¯¥æ–‡ä»¶ // è¾“å…¥:wqä¿å­˜ 5ã€ç»™æœåŠ¡å™¨è®¢é˜…mod ä½¿ç”¨ä»¥ä¸‹åœ¨çº¿æœåŠ¡dst-mod-config-converterå°†å·²ç»åˆ›å»ºçš„æœåŠ¡å™¨ä¸­çš„modoverrides.luaæ–‡ä»¶è½¬æ¢ä¸ºdedicated_server_mods_setup.luaæ–‡ä»¶ä¸­æ‰€éœ€çš„å†…å®¹ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\nä»å®¢æˆ·ç«¯æ‰¾åˆ° modoverrides.lua æ–‡ä»¶ é€šå¸¸ä½äºï¼š.klei/DoNotStarveTogether/å®¢æˆ·ç«¯è®¾ç½®/Cluster_1/Master/modoverrides.lua å’Œ .klei/DoNotStarveTogether/å®¢æˆ·ç«¯è®¾ç½®/Cluster_1/Caves/modoverrides.lua å°†æ–‡ä»¶å†…å®¹ç²˜è´´åˆ°dst-mod-config-converterå¯¹åº”çš„è¾“å…¥æ¡†ï¼Œå³å¯åœ¨çº¿å¿«é€Ÿè½¬æ¢ ç‚¹å‡»ç”ŸæˆæŒ‰é’® å¤åˆ¶ç”Ÿæˆçš„å†…å®¹åˆ°æœåŠ¡å™¨çš„ dedicated_server_mods_setup.lua cd /dontstarvetogether_dedicated_server/mods vim dedicated_server_mods_setup.lua // æŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼ // å°†ç”Ÿæˆçš„å†…å®¹å¤åˆ¶è¿›è¯¥æ–‡ä»¶ // è¾“å…¥:wqä¿å­˜ 6ã€ ç¼–å†™å¯åŠ¨è„šæœ¬ å›åˆ°æ ¹ç›®å½•ï¼Œåˆ›å»ºboot.shæ–‡ä»¶\ncd ~ vim boot.sh æŠŠä¸‹é¢çš„å‘½ä»¤ç²˜è´´åˆ°boot.shä¸­\n#!/bin/bash # steamcmdè·¯å¾„ steamcmd_dir=\u0026#34;$HOME/Steam\u0026#34; # é¥¥è’è”æœºç‰ˆå®‰è£…è·¯å¾„ install_dir=\u0026#34;$HOME/dontstarvetogether_dedicated_server\u0026#34; cluster_name=\u0026#34;Cluster_1\u0026#34; dontstarve_dir=\u0026#34;$HOME/.klei/DoNotStarveTogether\u0026#34; function fail() { echo Error: \u0026#34;$@\u0026#34; \u0026gt;\u0026amp;2 exit 1 } function check_for_file() { if [ ! -e \u0026#34;$1\u0026#34; ]; then fail \u0026#34;Missing file: $1\u0026#34; fi } cd \u0026#34;$steamcmd_dir\u0026#34; || fail \u0026#34;Missing $steamcmd_dir directory!\u0026#34; check_for_file \u0026#34;steamcmd.sh\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/cluster.ini\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/cluster_token.txt\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/Master/server.ini\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/Caves/server.ini\u0026#34; check_for_file \u0026#34;$install_dir/bin\u0026#34; cd \u0026#34;$install_dir/bin\u0026#34; || fail run_shared=(./dontstarve_dedicated_server_nullrenderer) run_shared+=(-console) run_shared+=(-cluster \u0026#34;$cluster_name\u0026#34;) run_shared+=(-monitor_parent_process $$) run_shared+=(-shard) \u0026#34;${run_shared[@]}\u0026#34; Caves | sed \u0026#39;s/^/Caves: /\u0026#39; \u0026amp; \u0026#34;${run_shared[@]}\u0026#34; Master | sed \u0026#39;s/^/Master: /\u0026#39; è„šæœ¬ä¸­é»˜è®¤å¯åŠ¨çš„æ˜¯32ä½æœåŠ¡å™¨ï¼Œå¦‚æœæƒ³å¯åŠ¨64ä½æœåŠ¡ï¼Œåªéœ€è¦æ›´æ”¹è¿™ä¸¤è¡Œã€‚\n# 32bit cd \u0026#34;$install_dir/bin\u0026#34; || fail run_shared=(./dontstarve_dedicated_server_nullrenderer) # 64bit cd \u0026#34;$install_dir/bin64\u0026#34; || fail run_shared=(./dontstarve_dedicated_server_nullrenderer_x64) èµ‹äºˆboot.shæ‰§è¡Œæƒé™\nsudo chmod u+x boot.sh åˆ°è¿™é‡Œï¼Œé¥¥è’æœåŠ¡å™¨çš„éƒ¨ç½²å°±å…¨éƒ¨å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥è¿˜è¦å¼€æ”¾ç«¯å£ä»¥ä¾›å…¶ä»–äººè®¿é—®ã€‚\nå…­ã€å¼€æ”¾ç«¯å£ å…·ä½“éœ€è¦å¼€æ”¾çš„ç«¯å£å¯ä»¥æŸ¥çœ‹å­˜æ¡£æ–‡ä»¶å¤¹ä¸‹çš„è¿™å‡ ä¸ªæ–‡ä»¶\n# é¥¥è’ç«¯å£ï¼ŒUDPåè®® ~/.klei/DoNotStarveTogether/Cluster_1/cluster.ini ä¸­çš„ master_portã€‚ ~/.klei/DoNotStarveTogether/Cluster_1/Master/server.ini ä¸­çš„ server_portã€‚ ~/.klei/DoNotStarveTogether/Cluster_1/Caves/server.ini ä¸­çš„ server_port # steamç«¯å£ï¼ŒTCP+UDPåè®® ~/.klei/DoNotStarveTogether/Cluster_1/Caves/server.ini ä¸­çš„ master_server_portã€authentication æ³¨æ„å¼€æ”¾çš„åè®®ï¼Œé¥¥è’ç«¯å£éƒ½æ˜¯UDPåè®®ï¼Œsteamçš„ä¿é™©èµ·è§ä¸¤ç§åè®®éƒ½å¼€ã€‚\nä¸ƒã€å¯åŠ¨é¥¥è’æœåŠ¡å™¨ åˆ°æ ¹ç›®å½•ï¼Œä¹Ÿå°±æ˜¯boot.shæ‰€åœ¨çš„ç›®å½•ï¼Œè¿è¡Œä¸‹é¢çš„ä»£ç \nnohup ./boot.sh\u0026gt;root.log 2\u0026gt;\u0026amp;1 \u0026amp; æ‰§è¡Œåé¥¥è’æœåŠ¡å™¨ä¼šåœ¨åå°è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹è¾“å‡ºçš„æ—¥å¿—\ntail -f root.log å…«ã€å…³é—­æœåŠ¡å™¨ å› ä¸ºæ˜¯åå°è¿è¡Œï¼Œå…³é—­æœåŠ¡å™¨éœ€è¦å…ˆæ‰¾åˆ°æœåŠ¡å™¨çš„PIDï¼Œç„¶åç”¨killå‘½ä»¤æ€æ­»\nps -ef | grep don kill [pid] ä¹ã€ä½¿ç”¨ systemd ç®¡ç†é¥¥è’æœåŠ¡å™¨å¯åŠ¨è„šæœ¬ï¼ˆå¯é€‰ï¼‰ ä»¥ä¸‹æ˜¯åŸºäºæ‚¨çš„ boot.sh è„šæœ¬ï¼Œä½¿ç”¨ systemd ç®¡ç†é¥¥è’æœåŠ¡å™¨çš„å®Œæ•´é…ç½®å’Œæ“ä½œæŒ‡å—ã€‚\n1ã€å‡†å¤‡å·¥ä½œ ç¡®ä¿è„šæœ¬è·¯å¾„ï¼š\nç¡®è®¤æ‚¨çš„ boot.shæ–‡ä»¶ä½äº /home/steam/boot.shï¼Œå¹¶ä¸”è¯¥è„šæœ¬æœ‰æ‰§è¡Œæƒé™ã€‚\nchmod +x /home/steam/boot.sh ä¿®æ”¹boot.shæ–‡ä»¶\nåœ¨è„šæœ¬é¡¶éƒ¨æ·»åŠ trap 'kill $(jobs -p)' SIGINT SIGTERM\nåœ¨è„šæœ¬æœ«å°¾æ·»åŠ  wait å‘½ä»¤ï¼Œç¡®ä¿è„šæœ¬è¿è¡Œæ—¶ï¼Œä¸»è„šæœ¬ä¸ä¼šåœ¨åå°å­è¿›ç¨‹è¿˜æœªé€€å‡ºæ—¶ç›´æ¥ç»ˆæ­¢\næœ€ç»ˆbash.shæ–‡ä»¶å¦‚ä¸‹ï¼š\n#!/bin/bash # steamcmdè·¯å¾„ steamcmd_dir=\u0026#34;$HOME/Steam\u0026#34; # é¥¥è’è”æœºç‰ˆå®‰è£…è·¯å¾„ install_dir=\u0026#34;$HOME/dontstarvetogether_dedicated_server\u0026#34; cluster_name=\u0026#34;Cluster_1\u0026#34; dontstarve_dir=\u0026#34;$HOME/.klei/DoNotStarveTogether\u0026#34; # åœ¨ boot.sh ä¸­æ•è·ç»ˆæ­¢ä¿¡å·ï¼Œå¹¶ç¡®ä¿æ‰€æœ‰å­è¿›ç¨‹åœ¨åœæ­¢æ—¶è¢«æ­£ç¡®æ¸…ç† trap \u0026#39;kill $(jobs -p)\u0026#39; SIGINT SIGTERM function fail() { echo Error: \u0026#34;$@\u0026#34; \u0026gt;\u0026amp;2 exit 1 } function check_for_file() { if [ ! -e \u0026#34;$1\u0026#34; ]; then fail \u0026#34;Missing file: $1\u0026#34; fi } cd \u0026#34;$steamcmd_dir\u0026#34; || fail \u0026#34;Missing $steamcmd_dir directory!\u0026#34; check_for_file \u0026#34;steamcmd.sh\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/cluster.ini\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/cluster_token.txt\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/Master/server.ini\u0026#34; check_for_file \u0026#34;$dontstarve_dir/$cluster_name/Caves/server.ini\u0026#34; check_for_file \u0026#34;$install_dir/bin\u0026#34; cd \u0026#34;$install_dir/bin\u0026#34; || fail run_shared=(./dontstarve_dedicated_server_nullrenderer) run_shared+=(-console) run_shared+=(-cluster \u0026#34;$cluster_name\u0026#34;) run_shared+=(-monitor_parent_process $$) run_shared+=(-shard) \u0026#34;${run_shared[@]}\u0026#34; Caves | sed \u0026#39;s/^/Caves: /\u0026#39; \u0026amp; \u0026#34;${run_shared[@]}\u0026#34; Master | sed \u0026#39;s/^/Master: /\u0026#39; wait åˆ›å»ºæ—¥å¿—ç›®å½•ï¼š\nå¦‚æœæ‚¨çš„ boot.shæ²¡æœ‰æŒ‡å®šæ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå»ºè®®è®¾ç½®ä¸€ä¸ªæ—¥å¿—ç›®å½•ï¼Œä¾‹å¦‚ï¼š\nmkdir -p /home/steam/logs 2ã€åˆ›å»º systemd æœåŠ¡æ–‡ä»¶ åˆ›å»ºæœåŠ¡æ–‡ä»¶ï¼š\nåœ¨ /etc/systemd/system/ ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæœåŠ¡æ–‡ä»¶ dst_server.serviceï¼š\nsudo nano /etc/systemd/system/dst_server.service å¡«å†™æœåŠ¡é…ç½®ï¼š\nå°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹å¿…è¦çš„è·¯å¾„ï¼š\n[Unit] Description=Don\u0026#39;t Starve Together Dedicated Server After=network.target [Service] User=steam Group=steam WorkingDirectory=/home/steam ExecStart=/home/steam/boot.sh ExecStop=/bin/kill -TERM $MAINPID KillMode=control-group Restart=on-failure RestartSec=5s StandardOutput=append:/home/steam/logs/dst_server.log StandardError=append:/home/steam/logs/dst_server_error.log [Install] WantedBy=multi-user.target è¯´æ˜ï¼š\nUser å’Œ Groupï¼šæŒ‡å®šè¿è¡ŒæœåŠ¡çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼ˆæ­¤å¤„ä¸º steamï¼‰ã€‚ WorkingDirectoryï¼šè„šæœ¬çš„å·¥ä½œç›®å½•ã€‚ ExecStartï¼šè¿è¡Œ boot.sh è„šæœ¬ã€‚ Restart=on-failureï¼šåœ¨è„šæœ¬å¤±è´¥æ—¶è‡ªåŠ¨é‡å¯æœåŠ¡ã€‚ StandardOutput å’Œ StandardErrorï¼šå°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯æ—¥å¿—åˆ†åˆ«å†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚ ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºï¼š æŒ‰ Ctrl+O ä¿å­˜ï¼ŒæŒ‰ Ctrl+X é€€å‡ºç¼–è¾‘å™¨ã€‚\né‡æ–°åŠ è½½ systemd é…ç½®ï¼š\nsudo systemctl daemon-reload 3ã€å¯åŠ¨å’Œç®¡ç†æœåŠ¡ å¯åŠ¨æœåŠ¡ï¼š\nsudo systemctl start dst_server è®¾ç½®å¼€æœºè‡ªå¯ï¼š\nsudo systemctl enable dst_server æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š\nsudo systemctl status dst_server åœæ­¢æœåŠ¡ï¼š\nsudo systemctl stop dst_server é‡å¯æœåŠ¡ï¼š\nsudo systemctl restart dst_server 4ã€æŸ¥çœ‹å’Œåˆ†ææ—¥å¿— å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼š\nsudo journalctl -u dst_server -f æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µæ—¥å¿—ï¼š\nsudo journalctl -u dst_server --since \u0026#34;2025-01-01 00:00:00\u0026#34; æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š å¦‚æœä½¿ç”¨ StandardOutput å’Œ StandardError å°†æ—¥å¿—è®°å½•åˆ°æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ tail æŸ¥çœ‹ï¼š\ntail -f /home/steam/logs/dst_server.log 5ã€æ³¨æ„äº‹é¡¹ ç¡®ä¿ steam ç”¨æˆ·å¯¹ /home/steam/boot.sh å’Œæ—¥å¿—ç›®å½•å…·æœ‰è¯»å†™æƒé™ã€‚\nå¦‚æœä¿®æ”¹äº† dst_server.serviceæ–‡ä»¶å†…å®¹ï¼Œè®°å¾—é‡æ–°åŠ è½½ systemdé…ç½®ï¼š\nsudo systemctl daemon-reload å¦‚æœæœåŠ¡æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œæ£€æŸ¥æ—¥å¿—æ–‡ä»¶æˆ–è¿è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é”™è¯¯ï¼š\nsudo journalctl -u dst_server ç›¸å…³é“¾æ¥ https://developer.valvesoftware.com/wiki/Zh/SteamCMD\nhttps://zhuanlan.zhihu.com/p/625645476\nhttps://accounts.klei.com/account/info\nhttps://github.com/ACAne0320/dst-mod-config-converter\nhttps://dst-mod-config-converter.vercel.app\n","permalink":"https://blog.nyaashino.com/post/dst_server_configuration/","summary":"é¥¥è’æœåŠ¡å™¨é…ç½® æœºå™¨é…ç½® ä¸»æœºé…ç½® ç³»ç»Ÿç‰ˆæœ¬ï¼šWindows 11 23H2\næœåŠ¡å™¨ è…¾è®¯äº‘è½»é‡çº§æœåŠ¡å™¨\né…ç½®ï¼š2C4G\nå­˜å‚¨ï¼šSSDäº‘ç¡¬ç›˜ 70GB\næµé‡ï¼š600GB/æœˆï¼ˆå¸¦å®½ï¼š6Mbpsï¼‰\né•œåƒï¼šUbuntu22.04-Docker26\nä¸€ã€ä¸‹è½½SteamCMD 1ã€åˆ›å»ºæ–°ç”¨æˆ· åˆ›å»ºä¸€ä¸ªåä¸º steam çš„ç”¨æˆ·å¸æˆ·ä»¥å®‰å…¨åœ°è¿è¡Œ SteamCMDï¼Œå¹¶å°†å…¶ä¸æ“ä½œç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†éš”ç¦»ã€‚ä»¥ root ç”¨æˆ·èº«ä»½ç™»å½•æ—¶è¯·å‹¿è¿è¡Œ steamcmdâ€”â€”è¿™æ ·åšä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚\n1.ä»¥ root ç”¨æˆ·èº«ä»½åˆ›å»º steam ç”¨æˆ·ï¼š useradd -m steam or sudo useradd -m steam 2.è®¾ç½®å¯†ç  sudo passwd steam 3.åˆ‡æ¢åˆ°steamç”¨æˆ· su - steam çœ‹åˆ° $ æç¤ºç¬¦å°±ç®—åˆ‡æ¢æˆåŠŸ\nubuntu@VM-8-7-ubuntu:~$ su - steam Password: $ $ ä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®è®¤å½“å‰ç”¨æˆ·ï¼š\nwhoami è¾“å‡ºåº”ä¸ºï¼š\nsteam ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç¡®è®¤å½“å‰ç›®å½•ï¼š\npwd è¾“å‡ºåº”ä¸ºï¼š\n/home/steam 4.ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ä¸º steam ç”¨æˆ·èµ‹äºˆ sudo æƒé™ 1.åˆ‡æ¢å›ç®¡ç†å‘˜è´¦æˆ·ï¼ˆå¦‚ ubuntu ç”¨æˆ·ï¼‰ï¼š\nexit 2.","title":"é¥¥è’æœåŠ¡å™¨é…ç½®ï¼ˆè…¾è®¯äº‘ï¼‰"},{"content":"å‰è¨€ ä¸çŸ¥ä¸è§‰2024å¹´ä¹Ÿè¿‡å»äº†ä¸€å¤§åŠäº†ï¼Œå…¬å¸çš„å„ç§å˜åŠ¨è®©æˆ‘ä¸§å¤±äº†å¯¹å·¥ä½œçš„çƒ­æƒ…ï¼Œå­¦ä¸åˆ°æ–°çš„æŠ€æœ¯ï¼Œæ²¡æœ‰æ–°çš„éœ€æ±‚ï¼Œè¦åšçš„ä»…ä»…æ˜¯è¿è¥ç®€å•çš„æœºå™¨å­¦ä¹ é¡¹ç›®ï¼Œæˆ‘æ—¶å¸¸æ€è€ƒè¿™æ ·çš„å·¥ä½œèƒ½ä¸ºæˆ‘å¸¦æ¥ä»€ä¹ˆï¼Ÿæˆ‘çš„é¢†å¯¼å¯¹æˆ‘å¾ˆå¥½ï¼Œæˆ‘ä¹Ÿå¾ˆæ„Ÿè°¢ä»–å¯¹æˆ‘çš„åŸ¹å…»ï¼Œä½†æ˜¯â€¦â€¦\né¼“èµ·å‹‡æ°” åœ¨å¬é—»éœ€è¦è°ƒæ•´è–ªèµ„æ—¶ï¼Œæˆ‘è„‘è¢‹é‡Œä¸€ç‰‡ç©ºç™½ï¼Œä¹‹å‰æƒ³ç€å…¬å¸åœ¨æˆ‘æœ€å›°éš¾çš„æ—¶å€™æ„¿æ„è®©æˆ‘è¿›å»å­¦ä¹ ï¼Œè€Œæˆ‘èƒ½ä¸ºå…¬å¸åšäº›ä»€ä¹ˆå‘¢ï¼Ÿèƒ½é™ªä¼´ä»–å¤šä¹…å‘¢ï¼Ÿç°åœ¨çœ‹æ¥ï¼Œå¯¹äºæˆ‘æœ¬å°±ä¸é«˜çš„å·¥èµ„ï¼Œåœ¨å‹åŠ›å·¨å¤§çš„ä»Šå¤©ï¼ŒæŠ›å»æˆ¿ç§Ÿç­‰æ—¥å¸¸å¼€é”€ï¼Œéƒ½ä¸èƒ½éšå¿ƒæ‰€æ¬²çš„æƒ³åƒä»€ä¹ˆå°±åƒä»€ä¹ˆäº†ã€‚ æ‰¿è¯ºçš„ä¸€å¹´è°ƒè–ªä¸¤æ¬¡ä¹Ÿå¹¶æ²¡æœ‰åšåˆ°ï¼Œç”šè‡³è¿˜è¦é™è–ªã€‚å¥½åƒæ˜¯æˆ‘ä¸èƒ½æ¥å—çš„ï¼Œæˆ‘æ€æ¥æƒ³å»ã€‚\nåœ¨æ”¶åˆ°è–ªèµ„è°ƒæ•´æ„å‘çš„ä¸€ä¸ªæœˆä¹‹åï¼Œæˆ‘æ‰ä¸‹å®šå†³å¿ƒæ‰¾ä¸‹ä¸€ä»½å·¥ä½œã€‚\nçœ‹ä¸åˆ°æŠ€æœ¯è¿›æ­¥çš„å·¥ä½œã€ä¸€è¶Ÿä¸€ä¸ªåŠå°æ—¶çš„é€šå‹¤ã€éœ€è¦è°ƒæ•´çš„è–ªèµ„ï¼Œæ˜¯å‹æ­»éª†é©¼çš„æœ€åä¸€æ ¹ç¨»è‰ã€‚\nåŠªåŠ›â€¦â€¦ä¼šæœ‰å›æŠ¥å—ï¼Ÿ æˆ‘ä¸çŸ¥é“ã€‚\nä¸‹ç­çš„è·¯ä¸Šï¼ŒåŒäº‹å’Œæˆ‘è¯´ï¼š\nâ€œæˆ‘ä»¬æ˜¯åœ¨è¿™é‡Œå¹²äº†è¿™ä¹ˆä¹…äº†ï¼Œä¹Ÿä¸å¤ªå¥½æ‰¾ä¸‹å®¶ã€‚ä½ ä¸ä¸€æ ·ï¼Œè¶ç€ä½ è¿˜å¹´è½»ï¼Œå»æ‹¼ä¸€ä¸‹å§ã€‚â€\næ˜¯å•Šï¼Œè¿˜å¹´è½»ï¼Œæ˜¯æ—¶å€™æ‹¼ä¸€ä¸‹äº†ã€‚\nç¬¬ä¸€æ¬¡é¢è¯•ç½‘æ˜“å¤–åŒ…ç»™æˆ‘çš„æ‰“å‡»å¤ªå¤§äº†ï¼Œæˆ‘å‘ç°æˆ‘å¥½åƒä»€ä¹ˆéƒ½ä¸ä¼šã€‚äºæ˜¯è¿™ä¸€ä¸ªæœˆä»¥æ¥ï¼Œä¸ƒç‚¹èµ·åºŠï¼Œä¸€ä¸¤ç‚¹æ‰ç¡è§‰ï¼Œæ¯å¤©éƒ½å¾ˆç–²æƒ«ï¼Œä¸‹ç­åä¿®æ”¹ç®€å†ã€èƒŒå…«è‚¡æ–‡ã€çœ‹ä¹¦äº†è§£Pythoné«˜çº§ç”¨æ³•(Fluent Python)ã€äº†è§£k8s/Dockerç­‰ç­‰â€¦â€¦\nå‡ ä¹æ²¡æœ‰å…¶ä»–é¢å¤–å¼€é”€çš„æˆ‘ï¼Œå±…ç„¶ä¹Ÿæ”’ä¸ä¸‹ä»€ä¹ˆé’±ï¼Œå‹‰å¼ºå¤Ÿä¸‹ä¸€ä¸ªæœˆçš„æˆ¿ç§Ÿã€‚ æˆ‘ç”šè‡³æ€€ç–‘æ˜¯ä¸æ˜¯æˆ‘çš„æ°´å¹³åªå¤Ÿä¸€ä»½æœˆè–ª7500çš„å·¥ä½œï¼Ÿå™¢ä¸â€¦â€¦ç”šè‡³è¿˜è¦é™ã€‚\nåœ¨é¢è¯•äº†å‡ å®¶ä¹‹åï¼Œæˆ‘è§‰å¾—æˆ‘çš„æ°´å¹³å¯¹åº”çš„è–ªèµ„è¿œä¸æ­¢å¦‚æ­¤ï¼Œæˆ‘è§‰å¾—æˆ‘å¯ä»¥æœ‰æ›´å¤§çš„å¤©åœ°â€¦â€¦å¦‚æœæˆ‘é¢è¯•ä¸ç´§å¼ èƒ½æŠŠè„‘å­é‡Œçš„çŸ¥è¯†éƒ½å¥½å¥½è¡¨è¾¾å‡ºæ¥çš„è¯ã€‚\nå‹‡æ•¢è¿ˆå‘æœªæ¥ æˆ‘å¼€å§‹ç–¯ç‹‚æŠ•ç®€å†æ‰¾é¢è¯•çš„æœºä¼šï¼Œæˆ‘æƒ³ç»™æˆ‘è‡ªå·±/ç»™æˆ‘çˆ±çš„äººæ›´å¥½çš„ç”Ÿæ´»ï¼Œç´¯ç‚¹è‹¦ç‚¹ä¹Ÿæ— æ‰€è°“ã€‚\næˆ‘ä»æœªæƒ³è¿‡åœ¨å·¥ä½œäº†è¿™ä¹ˆä¹…ä¹‹åï¼Œè¿˜æ˜¯åœ¨å¤©å¤©åƒæ³¡é¢ï¼Œä¸æ•¢å¤šèŠ±é’±ï¼Œæ›´åˆ«è¯´æ”’ä¸‹ä¸€ç¬”é’±äº†ã€‚\næ—¢ç„¶é€‰æ‹©äº†ï¼Œå°±åŠªåŠ›çš„å»å®ç°å®ƒï¼Œæ— è®ºç»“æœå¦‚ä½•ã€‚\nè¿‡ç¨‹æ°¸è¿œéƒ½ä¼šè®©ä½ åˆ‡å®åœ°æ„Ÿè§‰åˆ°ä½ è‡ªå·±çš„è¿›æ­¥ã€‚\nTruth the Process.\nç»“è¯­ å¸Œæœ›åœ¨ä½ è¿·èŒ«çš„æ—¶å€™ï¼Œæ‰¾åˆ°ä¸€ä¸ªç›®æ ‡ï¼Œæ— è®ºç›®æ ‡æœ‰å¤šéš¾ï¼Œé¦–å…ˆå¾—å…ˆå»åšã€‚åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ­¥ä¸€æ­¥æ¥è¿‘è‡ªå·±çš„ç›®æ ‡ï¼Œå›å¤´æ¥çœ‹ï¼Œä½ ä¼šæ„Ÿè°¢é‚£ä¸ªå‹‡äºå°è¯•çš„è‡ªå·±ã€‚\n","permalink":"https://blog.nyaashino.com/post/2024_review/","summary":"å‰è¨€ ä¸çŸ¥ä¸è§‰2024å¹´ä¹Ÿè¿‡å»äº†ä¸€å¤§åŠäº†ï¼Œå…¬å¸çš„å„ç§å˜åŠ¨è®©æˆ‘ä¸§å¤±äº†å¯¹å·¥ä½œçš„çƒ­æƒ…ï¼Œå­¦ä¸åˆ°æ–°çš„æŠ€æœ¯ï¼Œæ²¡æœ‰æ–°çš„éœ€æ±‚ï¼Œè¦åšçš„ä»…ä»…æ˜¯è¿è¥ç®€å•çš„æœºå™¨å­¦ä¹ é¡¹ç›®ï¼Œæˆ‘æ—¶å¸¸æ€è€ƒè¿™æ ·çš„å·¥ä½œèƒ½ä¸ºæˆ‘å¸¦æ¥ä»€ä¹ˆï¼Ÿæˆ‘çš„é¢†å¯¼å¯¹æˆ‘å¾ˆå¥½ï¼Œæˆ‘ä¹Ÿå¾ˆæ„Ÿè°¢ä»–å¯¹æˆ‘çš„åŸ¹å…»ï¼Œä½†æ˜¯â€¦â€¦\né¼“èµ·å‹‡æ°” åœ¨å¬é—»éœ€è¦è°ƒæ•´è–ªèµ„æ—¶ï¼Œæˆ‘è„‘è¢‹é‡Œä¸€ç‰‡ç©ºç™½ï¼Œä¹‹å‰æƒ³ç€å…¬å¸åœ¨æˆ‘æœ€å›°éš¾çš„æ—¶å€™æ„¿æ„è®©æˆ‘è¿›å»å­¦ä¹ ï¼Œè€Œæˆ‘èƒ½ä¸ºå…¬å¸åšäº›ä»€ä¹ˆå‘¢ï¼Ÿèƒ½é™ªä¼´ä»–å¤šä¹…å‘¢ï¼Ÿç°åœ¨çœ‹æ¥ï¼Œå¯¹äºæˆ‘æœ¬å°±ä¸é«˜çš„å·¥èµ„ï¼Œåœ¨å‹åŠ›å·¨å¤§çš„ä»Šå¤©ï¼ŒæŠ›å»æˆ¿ç§Ÿç­‰æ—¥å¸¸å¼€é”€ï¼Œéƒ½ä¸èƒ½éšå¿ƒæ‰€æ¬²çš„æƒ³åƒä»€ä¹ˆå°±åƒä»€ä¹ˆäº†ã€‚ æ‰¿è¯ºçš„ä¸€å¹´è°ƒè–ªä¸¤æ¬¡ä¹Ÿå¹¶æ²¡æœ‰åšåˆ°ï¼Œç”šè‡³è¿˜è¦é™è–ªã€‚å¥½åƒæ˜¯æˆ‘ä¸èƒ½æ¥å—çš„ï¼Œæˆ‘æ€æ¥æƒ³å»ã€‚\nåœ¨æ”¶åˆ°è–ªèµ„è°ƒæ•´æ„å‘çš„ä¸€ä¸ªæœˆä¹‹åï¼Œæˆ‘æ‰ä¸‹å®šå†³å¿ƒæ‰¾ä¸‹ä¸€ä»½å·¥ä½œã€‚\nçœ‹ä¸åˆ°æŠ€æœ¯è¿›æ­¥çš„å·¥ä½œã€ä¸€è¶Ÿä¸€ä¸ªåŠå°æ—¶çš„é€šå‹¤ã€éœ€è¦è°ƒæ•´çš„è–ªèµ„ï¼Œæ˜¯å‹æ­»éª†é©¼çš„æœ€åä¸€æ ¹ç¨»è‰ã€‚\nåŠªåŠ›â€¦â€¦ä¼šæœ‰å›æŠ¥å—ï¼Ÿ æˆ‘ä¸çŸ¥é“ã€‚\nä¸‹ç­çš„è·¯ä¸Šï¼ŒåŒäº‹å’Œæˆ‘è¯´ï¼š\nâ€œæˆ‘ä»¬æ˜¯åœ¨è¿™é‡Œå¹²äº†è¿™ä¹ˆä¹…äº†ï¼Œä¹Ÿä¸å¤ªå¥½æ‰¾ä¸‹å®¶ã€‚ä½ ä¸ä¸€æ ·ï¼Œè¶ç€ä½ è¿˜å¹´è½»ï¼Œå»æ‹¼ä¸€ä¸‹å§ã€‚â€\næ˜¯å•Šï¼Œè¿˜å¹´è½»ï¼Œæ˜¯æ—¶å€™æ‹¼ä¸€ä¸‹äº†ã€‚\nç¬¬ä¸€æ¬¡é¢è¯•ç½‘æ˜“å¤–åŒ…ç»™æˆ‘çš„æ‰“å‡»å¤ªå¤§äº†ï¼Œæˆ‘å‘ç°æˆ‘å¥½åƒä»€ä¹ˆéƒ½ä¸ä¼šã€‚äºæ˜¯è¿™ä¸€ä¸ªæœˆä»¥æ¥ï¼Œä¸ƒç‚¹èµ·åºŠï¼Œä¸€ä¸¤ç‚¹æ‰ç¡è§‰ï¼Œæ¯å¤©éƒ½å¾ˆç–²æƒ«ï¼Œä¸‹ç­åä¿®æ”¹ç®€å†ã€èƒŒå…«è‚¡æ–‡ã€çœ‹ä¹¦äº†è§£Pythoné«˜çº§ç”¨æ³•(Fluent Python)ã€äº†è§£k8s/Dockerç­‰ç­‰â€¦â€¦\nå‡ ä¹æ²¡æœ‰å…¶ä»–é¢å¤–å¼€é”€çš„æˆ‘ï¼Œå±…ç„¶ä¹Ÿæ”’ä¸ä¸‹ä»€ä¹ˆé’±ï¼Œå‹‰å¼ºå¤Ÿä¸‹ä¸€ä¸ªæœˆçš„æˆ¿ç§Ÿã€‚ æˆ‘ç”šè‡³æ€€ç–‘æ˜¯ä¸æ˜¯æˆ‘çš„æ°´å¹³åªå¤Ÿä¸€ä»½æœˆè–ª7500çš„å·¥ä½œï¼Ÿå™¢ä¸â€¦â€¦ç”šè‡³è¿˜è¦é™ã€‚\nåœ¨é¢è¯•äº†å‡ å®¶ä¹‹åï¼Œæˆ‘è§‰å¾—æˆ‘çš„æ°´å¹³å¯¹åº”çš„è–ªèµ„è¿œä¸æ­¢å¦‚æ­¤ï¼Œæˆ‘è§‰å¾—æˆ‘å¯ä»¥æœ‰æ›´å¤§çš„å¤©åœ°â€¦â€¦å¦‚æœæˆ‘é¢è¯•ä¸ç´§å¼ èƒ½æŠŠè„‘å­é‡Œçš„çŸ¥è¯†éƒ½å¥½å¥½è¡¨è¾¾å‡ºæ¥çš„è¯ã€‚\nå‹‡æ•¢è¿ˆå‘æœªæ¥ æˆ‘å¼€å§‹ç–¯ç‹‚æŠ•ç®€å†æ‰¾é¢è¯•çš„æœºä¼šï¼Œæˆ‘æƒ³ç»™æˆ‘è‡ªå·±/ç»™æˆ‘çˆ±çš„äººæ›´å¥½çš„ç”Ÿæ´»ï¼Œç´¯ç‚¹è‹¦ç‚¹ä¹Ÿæ— æ‰€è°“ã€‚\næˆ‘ä»æœªæƒ³è¿‡åœ¨å·¥ä½œäº†è¿™ä¹ˆä¹…ä¹‹åï¼Œè¿˜æ˜¯åœ¨å¤©å¤©åƒæ³¡é¢ï¼Œä¸æ•¢å¤šèŠ±é’±ï¼Œæ›´åˆ«è¯´æ”’ä¸‹ä¸€ç¬”é’±äº†ã€‚\næ—¢ç„¶é€‰æ‹©äº†ï¼Œå°±åŠªåŠ›çš„å»å®ç°å®ƒï¼Œæ— è®ºç»“æœå¦‚ä½•ã€‚\nè¿‡ç¨‹æ°¸è¿œéƒ½ä¼šè®©ä½ åˆ‡å®åœ°æ„Ÿè§‰åˆ°ä½ è‡ªå·±çš„è¿›æ­¥ã€‚\nTruth the Process.\nç»“è¯­ å¸Œæœ›åœ¨ä½ è¿·èŒ«çš„æ—¶å€™ï¼Œæ‰¾åˆ°ä¸€ä¸ªç›®æ ‡ï¼Œæ— è®ºç›®æ ‡æœ‰å¤šéš¾ï¼Œé¦–å…ˆå¾—å…ˆå»åšã€‚åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ­¥ä¸€æ­¥æ¥è¿‘è‡ªå·±çš„ç›®æ ‡ï¼Œå›å¤´æ¥çœ‹ï¼Œä½ ä¼šæ„Ÿè°¢é‚£ä¸ªå‹‡äºå°è¯•çš„è‡ªå·±ã€‚","title":"Do it for youself"},{"content":"é¡¹ç›®githubåœ°å€ï¼šhttps://github.com/hiyouga/LLaMA-Factory?tab=readme-ov-file\né¡¹ç›®hugging faceåœ°å€ï¼š\nä¸€ã€ç¯å¢ƒæ„å»º 1ã€åŸºç¡€è™šæ‹Ÿç¯å¢ƒæ„å»º git clone https://github.com/hiyouga/LLaMA-Factory.git conda create -n llama_factory python=3.10 conda activate llama_factory cd LLaMA-Factory pip install -r requirements.txt å¦‚æœè¦åœ¨ Windows å¹³å°ä¸Šå¼€å¯é‡åŒ– LoRAï¼ˆQLoRAï¼‰ï¼Œéœ€è¦å®‰è£…é¢„ç¼–è¯‘çš„ bitsandbytes åº“, æ”¯æŒ CUDA 11.1 åˆ° 12.2, è¯·æ ¹æ®æ‚¨çš„ CUDA ç‰ˆæœ¬æƒ…å†µé€‰æ‹©é€‚åˆçš„å‘å¸ƒç‰ˆæœ¬ã€‚\npip install https://github.com/jllllll/bitsandbytes-windows-webui/releases/download/wheels/bitsandbytes-0.41.2.post2-py3-none-win_amd64.whl 2ã€åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…cudaã€cudnn åœ¨æ–°å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨condaå®‰è£…cudaå’Œcudnnã€‚\nconda install cudatoolkit cudnn å®‰è£…å®Œæˆåï¼Œè¿›å…¥pythonç¯å¢ƒè¿›è¡ŒéªŒè¯ï¼Œæ£€æµ‹pytorchä¸­CUDAæ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨ã€‚\nimport torch torch.cuda.is_available() å¦‚æœè¿”å›Trueï¼Œåˆ™cudaå®‰è£…æ­£å¸¸ã€‚\nå¦‚æœè¿”å›Falseï¼Œè¯·æ£€æŸ¥cudaå’Œpytorchç‰ˆæœ¬æ˜¯å¦ç¬¦åˆã€‚\nä½¿ç”¨æ­¥éª¤1ä¸­çš„requirements.txtå®‰è£…æ—¶ï¼Œå¯èƒ½å®‰è£…çš„æ˜¯cpuç‰ˆæœ¬çš„pytorchï¼Œä½¿ç”¨conda listå‘½ä»¤æŸ¥çœ‹å®‰è£…çš„pytorchåŒ…ï¼Œå¦‚æœæ˜¯cpuç‰ˆï¼Œåˆ™éœ€è¦é‡æ–°å®‰è£…å¯¹åº”cudaç‰ˆæœ¬çš„gpuç‰ˆpytorchã€‚\nè¿›å…¥è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…gpuç‰ˆæœ¬çš„pytorchï¼Œä¸‹è¿°æ¼”ç¤ºçš„å‘½ä»¤å®‰è£…çš„ä¸ºé€‚é…cuda11.8ç‰ˆæœ¬çš„pytorchï¼Œè¯·æŒ‰éœ€é€‰æ‹©ç‰ˆæœ¬ã€‚\npip3 install numpy --pre torch --force-reinstall --index-url https://download.pytorch.org/whl/nightly/cu118 äºŒã€å¯åŠ¨LLaMA Board GUI 1ã€è®¾ç½®ç¯å¢ƒå˜é‡ CUDA_VISIBLE_DEVICES=0 python src/train_web.py åœ¨Windowsç³»ç»Ÿä¸‹ï¼Œè¯·è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡CUDA_VISIBLE_DEVICESçš„å€¼ä¸º0ã€‚\n2ã€å¯åŠ¨å›¾å½¢ç•Œé¢ å†åœ¨LLaMA-Factoryé¡¹ç›®ç›®å½•ä¸‹ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼š\npython src/train_web.py ä¸‰ã€é€‰æ‹©æ¨¡å‹è¿›è¡Œå¾®è°ƒ 1ã€æ¨¡å‹é€‰æ‹© åœ¨LLaMA-Factoryä¸­å¯¹ä»¥ä¸‹å¼€æºLLMæ¨¡å‹è¿›è¡Œäº†é€‚é…ï¼š\næ¨¡å‹å æ¨¡å‹å¤§å° é»˜è®¤æ¨¡å— Template Baichuan2 7B/13B W_pack baichuan2 BLOOM 560M/1.1B/1.7B/3B/7.1B/176B query_key_value - BLOOMZ 560M/1.1B/1.7B/3B/7.1B/176B query_key_value - ChatGLM3 6B query_key_value chatglm3 DeepSeek (MoE) 7B/16B/67B q_proj,v_proj deepseek Falcon 7B/40B/180B query_key_value falcon Gemma 2B/7B q_proj,v_proj gemma InternLM2 7B/20B wqkv intern2 LLaMA 7B/13B/33B/65B q_proj,v_proj - LLaMA-2 7B/13B/70B q_proj,v_proj llama2 Mistral 7B q_proj,v_proj mistral Mixtral 8x7B q_proj,v_proj mistral OLMo 1B/7B att_proj olmo Phi-1.5/2 1.3B/2.7B q_proj,v_proj - Qwen 1.8B/7B/14B/72B c_attn qwen Qwen1.5 0.5B/1.8B/4B/7B/14B/72B q_proj,v_proj qwen StarCoder2 3B/7B/15B q_proj,v_proj - XVERSE 7B/13B/65B q_proj,v_proj xverse Yi 6B/9B/34B q_proj,v_proj yi Yuan 2B/51B/102B q_proj,v_proj yuan å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨æœ¬åœ°çš„æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚åªéœ€åœ¨æ¨¡å‹è·¯å¾„ä¸­æŒ‡å®šæœ¬åœ°æ¨¡å‹çš„æ–‡ä»¶è·¯å¾„å³å¯ã€‚\n2ã€å¾®è°ƒæ–¹æ³•é€‰æ‹© fullï¼šå¯¹æ•´ä¸ªé¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå¾®è°ƒï¼ŒåŒ…æ‹¬æ‰€æœ‰æ¨¡å‹å‚æ•°ã€‚ freezeï¼šåªä½¿ç”¨å°‘éƒ¨åˆ†å‚æ•°è¿›è¡Œè®­ç»ƒï¼ŒæŠŠæ¨¡å‹çš„å¤§éƒ¨åˆ†å‚æ•°å†»ç»“ã€‚ loraï¼šæ’å…¥å°‘é‡å‚æ•°ï¼Œåªåœ¨æ–°æ’å…¥çš„å‚æ•°ä¸Šè¿›è¡Œå¾®è°ƒï¼Œè¾¾åˆ°åŠ é€Ÿæ•ˆæœã€‚å†»ç»“é¢„è®­ç»ƒæ¨¡å‹æƒé‡ï¼Œå°†å¯è®­ç»ƒçš„ç§©åˆ†è§£çŸ©é˜µæ³¨å…¥åˆ°Transformerå±‚æ¯ä¸ªæƒé‡ä¸­ã€‚ 3ã€è®­ç»ƒæ–¹æ³•é€‰æ‹© æ–¹æ³• å…¨å‚æ•°è®­ç»ƒ éƒ¨åˆ†å‚æ•°è®­ç»ƒ LoRA QLoRA é¢„è®­ç»ƒ âœ… âœ… âœ… âœ… æŒ‡ä»¤ç›‘ç£å¾®è°ƒ âœ… âœ… âœ… âœ… å¥–åŠ±æ¨¡å‹è®­ç»ƒ âœ… âœ… âœ… âœ… PPO è®­ç»ƒ âœ… âœ… âœ… âœ… DPO è®­ç»ƒ âœ… âœ… âœ… âœ… ORPO è®­ç»ƒ âœ… âœ… âœ… âœ… è¯·ä½¿ç”¨ --quantization_bit 4 å‚æ•°æ¥å¯ç”¨ QLoRA è®­ç»ƒã€‚\n4ã€æ•°æ®é›†é€‰æ‹© ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒ data/README_zh.md æ–‡ä»¶ã€‚\néƒ¨åˆ†æ•°æ®é›†çš„ä½¿ç”¨éœ€è¦ç¡®è®¤ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ä¸‹è¿°å‘½ä»¤ç™»å½•æ‚¨çš„ Hugging Face è´¦æˆ·ã€‚\npip install --upgrade huggingface_hub huggingface-cli login è‡ªå®šä¹‰æ•°æ®é›† å…³äºæ•°æ®é›†æ–‡ä»¶çš„æ ¼å¼ï¼Œè¯·å‚è€ƒ data/README_zh.md çš„å†…å®¹ã€‚æ„å»ºè‡ªå®šä¹‰æ•°æ®é›†æ—¶ï¼Œæ—¢å¯ä»¥ä½¿ç”¨å•ä¸ª .json æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ•°æ®åŠ è½½è„šæœ¬å’Œå¤šä¸ªæ–‡ä»¶ã€‚\nä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†æ—¶ï¼Œè¯·æ›´æ–° data/dataset_info.json æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æ ¼å¼è¯·å‚è€ƒ data/README_zh.mdã€‚\nå››ã€æ¨¡å‹è®­ç»ƒ å½“é€‰æ‹©å¥½è®­ç»ƒå‚æ•°åï¼Œç‚¹å‡»å¼€å§‹å³å¯è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚\nåœ¨å›¾å½¢ç•Œé¢ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è®­ç»ƒè¿›åº¦ã€æ—¥å¿—ä»¥åŠå®æ—¶æ˜¾ç¤ºçš„æŸå¤±å€¼å˜åŒ–ã€‚\näº”ã€æ¨¡å‹æ¨ç† å½“è®­ç»ƒå®Œæˆåï¼Œç‚¹å‡»åˆ·æ–°é€‚é…å™¨ï¼Œåœ¨é€‚é…å™¨è·¯å¾„é€‰æ‹©åˆšåˆšè®­ç»ƒå¥½çš„æ¨¡å‹ã€‚\nåœ¨Chatä¸­ç‚¹å‡»åŠ è½½æ¨¡å‹ã€‚\nè¾“å…¥æƒ³è¦æé—®çš„é—®é¢˜ï¼Œè¿›è¡Œæµ‹è¯•ã€‚\n","permalink":"https://blog.nyaashino.com/post/llamafactory_quickstart/","summary":"é¡¹ç›®githubåœ°å€ï¼šhttps://github.com/hiyouga/LLaMA-Factory?tab=readme-ov-file\né¡¹ç›®hugging faceåœ°å€ï¼š\nä¸€ã€ç¯å¢ƒæ„å»º 1ã€åŸºç¡€è™šæ‹Ÿç¯å¢ƒæ„å»º git clone https://github.com/hiyouga/LLaMA-Factory.git conda create -n llama_factory python=3.10 conda activate llama_factory cd LLaMA-Factory pip install -r requirements.txt å¦‚æœè¦åœ¨ Windows å¹³å°ä¸Šå¼€å¯é‡åŒ– LoRAï¼ˆQLoRAï¼‰ï¼Œéœ€è¦å®‰è£…é¢„ç¼–è¯‘çš„ bitsandbytes åº“, æ”¯æŒ CUDA 11.1 åˆ° 12.2, è¯·æ ¹æ®æ‚¨çš„ CUDA ç‰ˆæœ¬æƒ…å†µé€‰æ‹©é€‚åˆçš„å‘å¸ƒç‰ˆæœ¬ã€‚\npip install https://github.com/jllllll/bitsandbytes-windows-webui/releases/download/wheels/bitsandbytes-0.41.2.post2-py3-none-win_amd64.whl 2ã€åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…cudaã€cudnn åœ¨æ–°å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨condaå®‰è£…cudaå’Œcudnnã€‚\nconda install cudatoolkit cudnn å®‰è£…å®Œæˆåï¼Œè¿›å…¥pythonç¯å¢ƒè¿›è¡ŒéªŒè¯ï¼Œæ£€æµ‹pytorchä¸­CUDAæ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨ã€‚\nimport torch torch.cuda.is_available() å¦‚æœè¿”å›Trueï¼Œåˆ™cudaå®‰è£…æ­£å¸¸ã€‚\nå¦‚æœè¿”å›Falseï¼Œè¯·æ£€æŸ¥cudaå’Œpytorchç‰ˆæœ¬æ˜¯å¦ç¬¦åˆã€‚\nä½¿ç”¨æ­¥éª¤1ä¸­çš„requirements.txtå®‰è£…æ—¶ï¼Œå¯èƒ½å®‰è£…çš„æ˜¯cpuç‰ˆæœ¬çš„pytorchï¼Œä½¿ç”¨conda listå‘½ä»¤æŸ¥çœ‹å®‰è£…çš„pytorchåŒ…ï¼Œå¦‚æœæ˜¯cpuç‰ˆï¼Œåˆ™éœ€è¦é‡æ–°å®‰è£…å¯¹åº”cudaç‰ˆæœ¬çš„gpuç‰ˆpytorchã€‚\nè¿›å…¥è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…gpuç‰ˆæœ¬çš„pytorchï¼Œä¸‹è¿°æ¼”ç¤ºçš„å‘½ä»¤å®‰è£…çš„ä¸ºé€‚é…cuda11.8ç‰ˆæœ¬çš„pytorchï¼Œè¯·æŒ‰éœ€é€‰æ‹©ç‰ˆæœ¬ã€‚\npip3 install numpy --pre torch --force-reinstall --index-url https://download.pytorch.org/whl/nightly/cu118 äºŒã€å¯åŠ¨LLaMA Board GUI 1ã€è®¾ç½®ç¯å¢ƒå˜é‡ CUDA_VISIBLE_DEVICES=0 python src/train_web.py åœ¨Windowsç³»ç»Ÿä¸‹ï¼Œè¯·è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡CUDA_VISIBLE_DEVICESçš„å€¼ä¸º0ã€‚","title":"LLaMA-Factory Quickstart"},{"content":"æ—¢ç„¶éƒ½å»ºå¥½è‡ªå·±çš„åšå®¢äº†ï¼Œæ€»å¾—è®°å½•äº›ä»€ä¹ˆå§o.0ï¼Œäºæ˜¯ä¹â€¦â€¦\nä»Šå¤©æ˜¯ä¸€ä¸ªå€¼å¾—çºªå¿µçš„æ—¥å­ï¼Œä¸ºä»€ä¹ˆæï¼Ÿè¯·çœ‹~\nä¸€ã€å·¥ä½œ ä»å…¥èŒåˆ°ä»Šå¤©æ­£å¥½å››ä¸ªæœˆï¼Œä¹Ÿé¡ºåˆ©åº¦è¿‡äº†è¯•ç”¨æœŸï¼Œå·¥èµ„ä¹Ÿå‹‰å¼ºå¤Ÿç”Ÿæ´»ï¼ˆè™½ç„¶é™¤å»å¿…è¦çš„å¼€é”€ä¹‹åæ‰€å‰©æ— å‡ äº†ï¼Œè€Œä¸”è¿˜éœ€è¦è¿˜å‰å‡ ä¸ªæœˆä¸€ç‚¹æ”¶å…¥çš„æ²¡æœ‰çš„æ—¶å€™çš„å€ºï¼Œåœ¨æ­¤ç‰¹åˆ«æ„Ÿè°¢æ„¿æ„å€Ÿæˆ‘é’±çš„å¥½å“¥ä»¬ï¼Œè™½ç„¶ä½ ä»¬ä¸ä¸€å®šèƒ½è¯»åˆ°è¿™ç¯‡æ–‡ç« ï¼Œè™½ç„¶æˆ‘è¿˜é’±è¿˜çš„å¾ˆæ…¢ï¼Œä½†æ˜¯æˆ‘ä¼šåŠªåŠ›çš„QAQï¼‰ã€‚å·¥ä½œæ°›å›´ä¹Ÿå¥½ï¼Œå‹åŠ›ä¹Ÿæ²¡é‚£ä¹ˆå¤§ï¼Œå¾ˆå¹¸è¿é‡åˆ°è¿™æ ·çš„å…¬å¸ã€‚\näºŒã€ç”Ÿæ´» ä»Šå¤©æ¬è¿›æ–°æˆ¿å­å•¦ï¼Œæ˜¯ä¸€ä¸ªä¸€å®¤ä¸€å…ï¼Œè™½ç„¶å°äº†ç‚¹ï¼Œä½†æˆ‘è¿˜æ˜¯å¾ˆå–œæ¬¢çš„ï¼Œç§Ÿè¿‡ç¨‹å¾ˆæ„‰å¿«ï¼Œä¸­ä»‹ä¹Ÿå¥½ï¼Œæˆ¿ä¸œä¹Ÿå¥½ï¼Œéƒ½æ˜¯å¾ˆæœ‰çˆ±çš„äººã€‚å¯èƒ½æˆ‘çš„å¥½è¿éƒ½ç”¨åœ¨è¿™äº›åœ°æ–¹äº†å§ï¼Œä»å¾—åˆ°è¿™ä»½å·¥ä½œå¼€å§‹ï¼Œæœ€è¿‘ä¹Ÿå¾ˆå°‘æŠ±æ€¨ç”Ÿæ´»äº†ï¼Œæ…¢æ…¢å¼€å§‹å˜å¾—ç§¯æå‘ä¸Šäº†ã€‚å¾ˆæ„Ÿè°¢å½“æ—¶å¯¹æˆ‘æä¾›å¸®åŠ©çš„å„ä½è€å¸ˆä»¬ï¼Œå¸Œæœ›æˆ‘çš„è¡¨ç°å¹¶æ²¡æœ‰è®©ä½ ä»¬å¤±æœ›ï¼ˆè™½ç„¶ä¹Ÿä¸ä¸€å®šèƒ½è¯»åˆ°è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘è¦ç‚¹åè¡¨æ‰¬å†œè€å¸ˆï¼è™½ç„¶æˆ‘å½“é¢ä¸€ç›´è¯´ä¸å‡ºé‚£å¥æ„Ÿè°¢ğŸ˜„ï¼‰ã€‚\nä¸‰ã€æ–°çš„å¼€å§‹ æˆåŠŸè½¬æ­£äº†ï¼Œä¹Ÿç§Ÿäº†å±äºè‡ªå·±çš„ä¸€é—´æˆ¿å­ï¼ŒçœŸæ­£å‡ºæ¥å·¥ä½œä¹‹åæ‰çŸ¥é“åŸæ¥ç”Ÿæ´»è¿™ä¹ˆå›°éš¾ï¼Œå…‰æ˜¯ä¾›è‡ªå·±æ´»ä¸‹å»éƒ½è´¹å°½å…¨åŠ›äº†ã€‚ æ‰€ä»¥ç°åœ¨æˆ‘å¾ˆæ•¬ä½©é‚£äº›é è‡ªå·±çš„èƒ½åŠ›åŠªåŠ›æ´»åˆ°ç°åœ¨å¹¶ä¸”ä¿æŒä¹è§‚çš„äººï¼Œæˆ‘ä¹Ÿä¼šåŠªåŠ›çš„å‘ä»–ä»¬çœ‹é½ã€‚\næ’ä¸ªä»Šå¤©æ¬å®¶çš„å°æ•…äº‹ï¼š\nä»Šå¤©æ¬å®¶çš„æ—¶å€™å«äº†ä¸€ä¸ªè´§æ‹‰æ‹‰çš„å°é¢åŒ…è½¦ï¼Œå¸æœºä¹Ÿæ˜¯ä¸€ä¸ªåŠªåŠ›ã€ä¹è§‚åˆå¯çˆ±çš„äººï¼Œå’Œæˆ‘ä¸€æ ·ä¹Ÿæœ‰ç‚¹å†…å‘ï¼Œä½†æ˜¯æˆ‘èƒ½å¬å‡ºæ¥ä»–çš„å¾ˆå¤šè¯éƒ½æ˜¯å‘è‡ªå†…å¿ƒçš„ï¼Œå¯èƒ½è¿™å°±æ˜¯åŒæ€§ç›¸å¸å§ã€‚å‡ºå°åŒºçš„æ—¶å€™ï¼Œç”±äºåœè½¦è¶…è¿‡äº†åŠä¸ªå°æ—¶ï¼Œè¦ä»˜åœè½¦è´¹ï¼Œæˆ‘è¯´æˆ‘è½¬ç»™ä½ å§ï¼Œä»–è¯´ä¸ç”¨äº†ï¼Œå¤§å®¶éƒ½æŒºä¸å®¹æ˜“çš„ã€‚é‚£ä¸€ç¬é—´æˆ‘æœ‰ç‚¹æ„ŸåŠ¨ï¼Œä½†ä¹Ÿåªæ˜¯ç¬‘äº†ç¬‘è¯´è¿™æ ·ä¸å¥½å§ï¼Œç›´åˆ°æœ€åä»–ä¹Ÿæ²¡æ”¶æˆ‘çš„é’±ã€‚æˆ‘ä¹Ÿåªèƒ½å›å‡ å£°æ„Ÿè°¢ï¼Œä¸€æƒ³åˆ°å¯èƒ½å†ä¹Ÿæ²¡æœ‰ç¼˜åˆ†å†è§äº†ï¼Œæœ‰ç‚¹é—æ†¾å‘¢ã€‚ä½†æ˜¯äººç”Ÿå°±æ˜¯è¿™æ ·åœ¨ä¸€æ®µåˆä¸€æ®µé—æ†¾çš„ä¸­åº¦è¿‡çš„ï¼Œè°åˆèƒ½ä¸€å¸†é£é¡ºå‘¢ï¼Ÿ\nKeep calm and carry on!\nè™½ç„¶ç”Ÿæ´»å¾ˆéš¾ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯è¦ç»§ç»­å‰è¡Œã€‚\nåŠªåŠ›å˜æˆä¹è§‚åˆå…ƒæ°”æ»¡æ»¡çš„æ ·å­ï¼Œè°èƒ½æƒ³åˆ°ç°åœ¨è¿™æ ·çš„æˆ‘ï¼Œåœ¨ä¸€å¹´ä»¥å‰ï¼Œæ˜¯ä¸€ä¸ªé—¨éƒ½ä¸æ•¢å‡ºçš„ç‰ç‰ç—‡+è‡ªé—­ç—‡+ç¤¾æ+å›é¿å‹ä¾æ‹çš„äººå‘¢ï¼Ÿå¾ˆæ„Ÿè°¢è¿‡å¹´çš„æ—¶å€™ä¸€ç›´æ€è€ƒç€æ˜¯å¦è¦å‡ºå»æ‰“æ‹¼ã€å¥‹æ–—çš„è‡ªå·±ï¼Œæœªæ¥çš„ä½ å‘ä½ æŠ¥å–œå•¦ï¼Œä½ æˆåŠŸäº†ï¼è™½ç„¶ç°åœ¨ä¹Ÿå¾ˆè‡ªé—­ï¼Œä½†æ˜¯ç›¸æ¯”ä»¥å‰ï¼Œå·²ç»å¥½å¤ªå¤šäº†ï¼Œæˆ‘èƒ½çœ‹è§æˆ‘è‡ªå·±çš„è¿›æ­¥ï¼Œæ‰€ä»¥æˆ‘å¹¶ä¸è§‰å¾—æˆ‘æ¯”åˆ«äººå·®ã€‚\næœ€è¿‘åŠ ä¸Šåˆä¼‘æ¯å¤©ä¹Ÿåªç¡äº†å¤§æ¦‚ä¸ƒä¸ªå°æ—¶ï¼Œç¡çœ è´¨é‡æå·®ã€‚\nå¸Œæœ›æ¬åˆ°æ–°çš„ç¯å¢ƒä¸­ä¼šæœ‰æ‰€æ”¹å–„å§ğŸ™\n4ã€END æœ€åé€å¤§å®¶æ­£å¥½å¬åˆ°çš„ä¸€é¦–æ­Œçš„ä¸€æ®µæ­Œè¯ï¼š\nåªèƒ½ç”±æˆ‘è‡ªå·±æ¥è¸å‡ºè¿™ä¸€æ­¥ï¼Œä¸èƒ½åœ¨æ°´è¾¹å‚»å‚»ç­‰å¾…æ˜å¤©åˆ°æ¥ã€‚\n","permalink":"https://blog.nyaashino.com/post/new_begining/","summary":"æ—¢ç„¶éƒ½å»ºå¥½è‡ªå·±çš„åšå®¢äº†ï¼Œæ€»å¾—è®°å½•äº›ä»€ä¹ˆå§o.0ï¼Œäºæ˜¯ä¹â€¦â€¦\nä»Šå¤©æ˜¯ä¸€ä¸ªå€¼å¾—çºªå¿µçš„æ—¥å­ï¼Œä¸ºä»€ä¹ˆæï¼Ÿè¯·çœ‹~\nä¸€ã€å·¥ä½œ ä»å…¥èŒåˆ°ä»Šå¤©æ­£å¥½å››ä¸ªæœˆï¼Œä¹Ÿé¡ºåˆ©åº¦è¿‡äº†è¯•ç”¨æœŸï¼Œå·¥èµ„ä¹Ÿå‹‰å¼ºå¤Ÿç”Ÿæ´»ï¼ˆè™½ç„¶é™¤å»å¿…è¦çš„å¼€é”€ä¹‹åæ‰€å‰©æ— å‡ äº†ï¼Œè€Œä¸”è¿˜éœ€è¦è¿˜å‰å‡ ä¸ªæœˆä¸€ç‚¹æ”¶å…¥çš„æ²¡æœ‰çš„æ—¶å€™çš„å€ºï¼Œåœ¨æ­¤ç‰¹åˆ«æ„Ÿè°¢æ„¿æ„å€Ÿæˆ‘é’±çš„å¥½å“¥ä»¬ï¼Œè™½ç„¶ä½ ä»¬ä¸ä¸€å®šèƒ½è¯»åˆ°è¿™ç¯‡æ–‡ç« ï¼Œè™½ç„¶æˆ‘è¿˜é’±è¿˜çš„å¾ˆæ…¢ï¼Œä½†æ˜¯æˆ‘ä¼šåŠªåŠ›çš„QAQï¼‰ã€‚å·¥ä½œæ°›å›´ä¹Ÿå¥½ï¼Œå‹åŠ›ä¹Ÿæ²¡é‚£ä¹ˆå¤§ï¼Œå¾ˆå¹¸è¿é‡åˆ°è¿™æ ·çš„å…¬å¸ã€‚\näºŒã€ç”Ÿæ´» ä»Šå¤©æ¬è¿›æ–°æˆ¿å­å•¦ï¼Œæ˜¯ä¸€ä¸ªä¸€å®¤ä¸€å…ï¼Œè™½ç„¶å°äº†ç‚¹ï¼Œä½†æˆ‘è¿˜æ˜¯å¾ˆå–œæ¬¢çš„ï¼Œç§Ÿè¿‡ç¨‹å¾ˆæ„‰å¿«ï¼Œä¸­ä»‹ä¹Ÿå¥½ï¼Œæˆ¿ä¸œä¹Ÿå¥½ï¼Œéƒ½æ˜¯å¾ˆæœ‰çˆ±çš„äººã€‚å¯èƒ½æˆ‘çš„å¥½è¿éƒ½ç”¨åœ¨è¿™äº›åœ°æ–¹äº†å§ï¼Œä»å¾—åˆ°è¿™ä»½å·¥ä½œå¼€å§‹ï¼Œæœ€è¿‘ä¹Ÿå¾ˆå°‘æŠ±æ€¨ç”Ÿæ´»äº†ï¼Œæ…¢æ…¢å¼€å§‹å˜å¾—ç§¯æå‘ä¸Šäº†ã€‚å¾ˆæ„Ÿè°¢å½“æ—¶å¯¹æˆ‘æä¾›å¸®åŠ©çš„å„ä½è€å¸ˆä»¬ï¼Œå¸Œæœ›æˆ‘çš„è¡¨ç°å¹¶æ²¡æœ‰è®©ä½ ä»¬å¤±æœ›ï¼ˆè™½ç„¶ä¹Ÿä¸ä¸€å®šèƒ½è¯»åˆ°è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘è¦ç‚¹åè¡¨æ‰¬å†œè€å¸ˆï¼è™½ç„¶æˆ‘å½“é¢ä¸€ç›´è¯´ä¸å‡ºé‚£å¥æ„Ÿè°¢ğŸ˜„ï¼‰ã€‚\nä¸‰ã€æ–°çš„å¼€å§‹ æˆåŠŸè½¬æ­£äº†ï¼Œä¹Ÿç§Ÿäº†å±äºè‡ªå·±çš„ä¸€é—´æˆ¿å­ï¼ŒçœŸæ­£å‡ºæ¥å·¥ä½œä¹‹åæ‰çŸ¥é“åŸæ¥ç”Ÿæ´»è¿™ä¹ˆå›°éš¾ï¼Œå…‰æ˜¯ä¾›è‡ªå·±æ´»ä¸‹å»éƒ½è´¹å°½å…¨åŠ›äº†ã€‚ æ‰€ä»¥ç°åœ¨æˆ‘å¾ˆæ•¬ä½©é‚£äº›é è‡ªå·±çš„èƒ½åŠ›åŠªåŠ›æ´»åˆ°ç°åœ¨å¹¶ä¸”ä¿æŒä¹è§‚çš„äººï¼Œæˆ‘ä¹Ÿä¼šåŠªåŠ›çš„å‘ä»–ä»¬çœ‹é½ã€‚\næ’ä¸ªä»Šå¤©æ¬å®¶çš„å°æ•…äº‹ï¼š\nä»Šå¤©æ¬å®¶çš„æ—¶å€™å«äº†ä¸€ä¸ªè´§æ‹‰æ‹‰çš„å°é¢åŒ…è½¦ï¼Œå¸æœºä¹Ÿæ˜¯ä¸€ä¸ªåŠªåŠ›ã€ä¹è§‚åˆå¯çˆ±çš„äººï¼Œå’Œæˆ‘ä¸€æ ·ä¹Ÿæœ‰ç‚¹å†…å‘ï¼Œä½†æ˜¯æˆ‘èƒ½å¬å‡ºæ¥ä»–çš„å¾ˆå¤šè¯éƒ½æ˜¯å‘è‡ªå†…å¿ƒçš„ï¼Œå¯èƒ½è¿™å°±æ˜¯åŒæ€§ç›¸å¸å§ã€‚å‡ºå°åŒºçš„æ—¶å€™ï¼Œç”±äºåœè½¦è¶…è¿‡äº†åŠä¸ªå°æ—¶ï¼Œè¦ä»˜åœè½¦è´¹ï¼Œæˆ‘è¯´æˆ‘è½¬ç»™ä½ å§ï¼Œä»–è¯´ä¸ç”¨äº†ï¼Œå¤§å®¶éƒ½æŒºä¸å®¹æ˜“çš„ã€‚é‚£ä¸€ç¬é—´æˆ‘æœ‰ç‚¹æ„ŸåŠ¨ï¼Œä½†ä¹Ÿåªæ˜¯ç¬‘äº†ç¬‘è¯´è¿™æ ·ä¸å¥½å§ï¼Œç›´åˆ°æœ€åä»–ä¹Ÿæ²¡æ”¶æˆ‘çš„é’±ã€‚æˆ‘ä¹Ÿåªèƒ½å›å‡ å£°æ„Ÿè°¢ï¼Œä¸€æƒ³åˆ°å¯èƒ½å†ä¹Ÿæ²¡æœ‰ç¼˜åˆ†å†è§äº†ï¼Œæœ‰ç‚¹é—æ†¾å‘¢ã€‚ä½†æ˜¯äººç”Ÿå°±æ˜¯è¿™æ ·åœ¨ä¸€æ®µåˆä¸€æ®µé—æ†¾çš„ä¸­åº¦è¿‡çš„ï¼Œè°åˆèƒ½ä¸€å¸†é£é¡ºå‘¢ï¼Ÿ\nKeep calm and carry on!\nè™½ç„¶ç”Ÿæ´»å¾ˆéš¾ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯è¦ç»§ç»­å‰è¡Œã€‚\nåŠªåŠ›å˜æˆä¹è§‚åˆå…ƒæ°”æ»¡æ»¡çš„æ ·å­ï¼Œè°èƒ½æƒ³åˆ°ç°åœ¨è¿™æ ·çš„æˆ‘ï¼Œåœ¨ä¸€å¹´ä»¥å‰ï¼Œæ˜¯ä¸€ä¸ªé—¨éƒ½ä¸æ•¢å‡ºçš„ç‰ç‰ç—‡+è‡ªé—­ç—‡+ç¤¾æ+å›é¿å‹ä¾æ‹çš„äººå‘¢ï¼Ÿå¾ˆæ„Ÿè°¢è¿‡å¹´çš„æ—¶å€™ä¸€ç›´æ€è€ƒç€æ˜¯å¦è¦å‡ºå»æ‰“æ‹¼ã€å¥‹æ–—çš„è‡ªå·±ï¼Œæœªæ¥çš„ä½ å‘ä½ æŠ¥å–œå•¦ï¼Œä½ æˆåŠŸäº†ï¼è™½ç„¶ç°åœ¨ä¹Ÿå¾ˆè‡ªé—­ï¼Œä½†æ˜¯ç›¸æ¯”ä»¥å‰ï¼Œå·²ç»å¥½å¤ªå¤šäº†ï¼Œæˆ‘èƒ½çœ‹è§æˆ‘è‡ªå·±çš„è¿›æ­¥ï¼Œæ‰€ä»¥æˆ‘å¹¶ä¸è§‰å¾—æˆ‘æ¯”åˆ«äººå·®ã€‚\næœ€è¿‘åŠ ä¸Šåˆä¼‘æ¯å¤©ä¹Ÿåªç¡äº†å¤§æ¦‚ä¸ƒä¸ªå°æ—¶ï¼Œç¡çœ è´¨é‡æå·®ã€‚\nå¸Œæœ›æ¬åˆ°æ–°çš„ç¯å¢ƒä¸­ä¼šæœ‰æ‰€æ”¹å–„å§ğŸ™\n4ã€END æœ€åé€å¤§å®¶æ­£å¥½å¬åˆ°çš„ä¸€é¦–æ­Œçš„ä¸€æ®µæ­Œè¯ï¼š\nåªèƒ½ç”±æˆ‘è‡ªå·±æ¥è¸å‡ºè¿™ä¸€æ­¥ï¼Œä¸èƒ½åœ¨æ°´è¾¹å‚»å‚»ç­‰å¾…æ˜å¤©åˆ°æ¥ã€‚","title":"New Beginning!"},{"content":"BentoML åŸºæœ¬æµç¨‹ï¼š\ntrain.pyè®­ç»ƒæ¨¡å‹ ä½¿ç”¨bentomlä¿å­˜æ¨¡å‹ æ„å»ºservice.pyï¼Œåˆ›å»ºç›¸åº”çš„æœåŠ¡ åˆ›å»ºbentofile.yamlæ–‡ä»¶ ä½¿ç”¨å‘½ä»¤è¡Œbentoml build æ„å»ºBento å°†æ„å»ºå¥½çš„Bentoæ¨é€åˆ°Yataiä¸Šéƒ¨ç½² / åœ¨æœ¬åœ°ä½¿ç”¨å‘½ä»¤å¯åŠ¨æœåŠ¡ å‘é€é¢„æµ‹è¯·æ±‚ ä¸€ã€ä½¿ç”¨BentoMLä¿å­˜æ¨¡å‹ å¦‚æœæƒ³è¦å¼€å§‹ä½¿ç”¨BentoMLæœåŠ¡ï¼Œé¦–å…ˆéœ€è¦å°†è®­ç»ƒçš„æ¨¡å‹ä½¿ç”¨BentoMLçš„APIåœ¨æœ¬åœ°è¿›è¡Œä¿å­˜ã€‚\nbentoml.(framename).save_model(modelname, model)\nframenameå–å†³äºä½ æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ä½¿ç”¨çš„æ¡†æ¶ã€‚\nmodelnameä¸ºæ¨¡å‹ä¿å­˜åçš„åå­—ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬å­—æ®µï¼Œç”¨äºæ£€ç´¢æ¨¡å‹ã€‚\nmodelä¸ºä½ æ‰€æ„å»ºçš„æ¨¡å‹çš„å˜é‡å\nå‡å¦‚æˆ‘æ­¤å‰å·²ç»å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼š\nmnist_clf = 'tensorflow_mnist'\nmnist_model = tf.keras.models.load_model('models/mnist_model.h5')\né‚£ä¹ˆæœ‰ä»¥ä¸‹ä¿å­˜æ¨¡å‹çš„ä¾‹å­ï¼š\nbentoml.tensorflow.save_model(mnist_clf, mnist_model)\ne.g. åŸºäºsklearnå®ç°çš„irisæ•°æ®é›†æ¨¡å‹ï¼š\nimport bentoml from sklearn import svm from sklearn import datasets # Load training data set iris = datasets.load_iris() X, y = iris.data, iris.target # Train the model clf = svm.SVC(gamma=\u0026#39;scale\u0026#39;) clf.fit(X, y) # Save model to the BentoML local model store saved_model = bentoml.sklearn.save_model(\u0026#34;iris_clf\u0026#34;, clf) print(f\u0026#34;Model saved: {saved_model}\u0026#34;) # Model saved: Model(tag=\u0026#34;iris_clf:zy3dfgxzqkjrlgxi\u0026#34;) ä»¥ä¸‹æ˜¯BentoMLç›®å‰æ”¯æŒçš„æœºå™¨å­¦ä¹ æ¡†æ¶ï¼š\nCatBoost Diffusers fast.ai Keras LightGBM MLflow ONNX PyTorch PyTorch Lightning Scikit-Learn TensorFlow Transformers XGBoost Detectron2 EasyORC äºŒã€åˆ›å»ºæœåŠ¡ åˆ›å»ºä¸€ä¸ªservice.pyæ–‡ä»¶ä»¥æä¾›æœåŠ¡ï¼š\n# service.py import numpy as np from PIL.Image import Image as PILImage import bentoml from bentoml.io import Image from bentoml.io import NumpyNdarray # å®ä¾‹åŒ–runnerå¯¹è±¡ mnist_runner = bentoml.tensorflow.get(\u0026#34;tensorflow_mnist:latest\u0026#34;).to_runner() # åˆ›å»ºæœåŠ¡ svc = bentoml.Service( name=\u0026#34;tensorflow_mnist_demo\u0026#34;, runners=[mnist_runner], ) # æä¾›é¢„æµ‹æœåŠ¡çš„å‡½æ•° @svc.api(input=Image(), output=NumpyNdarray(dtype=\u0026#34;float32\u0026#34;)) async def predict_image(f: PILImage) -\u0026gt; \u0026#34;np.ndarray\u0026#34;: assert isinstance(f, PILImage) arr = np.array(f) / 255.0 assert arr.shape == (28, 28) # We are using greyscale image and our PyTorch model expect one # extra channel dimension arr = np.expand_dims(arr, (0, 3)).astype(\u0026#34;float32\u0026#34;) # reshape to [1, 28, 28, 1] return await mnist_runner.async_run(arr) ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯ä»¥å¯¹MNISTæ‰‹å†™æ•°å­—è¯†åˆ«æ•°æ®é›†ä¸­çš„å›¾ç‰‡è¿›è¡Œé¢„æµ‹çš„BentoMLæœåŠ¡äº†ã€‚\nä¸‰ã€æ„å»ºBento ä¸€æ—¦å®šä¹‰äº†æœåŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†æ¨¡å‹å’ŒæœåŠ¡åˆ¶ä½œæˆbentoï¼ŒBentoæ˜¯æœåŠ¡çš„å‘å¸ƒæ ¼å¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å½’æ¡£æ–‡ä»¶ï¼Œè¿è¡ŒæœåŠ¡æ‰€éœ€çš„æ‰€æœ‰æºä»£ç ã€æ¨¡å‹æ–‡ä»¶å’Œä¾èµ–å…³ç³»è§„èŒƒã€‚\nè¦æ„å»ºBentoï¼Œé¦–å…ˆè¦åœ¨é¡¹ç›®ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªbentofile.yamlæ–‡ä»¶ï¼š\nservice: \u0026#34;service:svc\u0026#34; description: \u0026#34;file: ./README.md\u0026#34; labels: owner: bentoml-team stage: demo include: - \u0026#34;*.py\u0026#34; exclude: - \u0026#34;locustfile.py\u0026#34; python: lock_packages: false packages: - tensorflow - Pillow BentoMLåœ¨bentofile.yamlä¸­æä¾›äº†å¤§é‡æ„å»ºé€‰é¡¹ï¼Œç”¨äºè‡ªå®šä¹‰Pythonä¾èµ–å…³ç³»ã€cudaå®‰è£…ã€dockeré•œåƒåˆ†å‘ç­‰ç­‰ã€‚æ›´å¤šæœ‰å…³bentofile.yamlé€‰é¡¹çš„ä¿¡æ¯è¯·ç‚¹å‡»æ„å»ºBentosã€‚\næ¥ä¸‹æ¥å°±å¯ä»¥åœ¨åŒ…å«service.pyå’Œbentofile.yamlæ–‡ä»¶çš„ç›®å½•ä¸‹æ„å»ºbentoäº†ï¼\nè¿è¡Œbentoml build CLI å‘½ä»¤ï¼š\n$ bentoml build â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•šâ•â•â•â•â•â•â• Successfully built Bento(tag=\u0026#34;tensorflow_mnist_demo:n5g45ibme2efgedi\u0026#34;). Possible next steps: * Containerize your Bento with `bentoml containerize`: $ bentoml containerize tensorflow_mnist_demo:n5g45ibme2efgedi [or bentoml build --containerize] * Push to BentoCloud with `bentoml push`: $ bentoml push tensorflow_mnist_demo:n5g45ibme2efgedi [or bentoml build --push] å½“ç„¶ ä½ ä¹Ÿå¯ä»¥æŒ‡å®šéœ€è¦æ„å»ºçš„bentoï¼š\nbentoml build -f ./src/my_project_a/bento_fraud_detect.yaml ./src/\nå’Œä¿å­˜æ¨¡å‹ç±»ä¼¼ï¼Œæ–°åˆ›å»ºçš„bentoä¹Ÿä¼šè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€çš„ç‰ˆæœ¬æ ‡ç­¾ã€‚\nä½ å¯ä»¥ä½¿ç”¨bentoml listæŸ¥çœ‹ä½ åœ¨æœ¬åœ°æ„å»ºçš„æ‰€æœ‰bento\nå½“ä½ æœ‰å¤šä¸ªbentoçš„æ—¶å€™ï¼Œä½ æ˜¯å¦éœ€è¦æ¸…ç†ä¸€äº›ä¸éœ€è¦çš„bentoï¼Ÿ\nä½ å¯ä»¥ä½¿ç”¨bentoml delete {bentoname:version}æ¥åˆ é™¤ä¸éœ€è¦çš„bento\nå››ã€è¿›è¡Œé¢„æµ‹ 1ã€æä¾›æœåŠ¡ ç›®å‰å·²çŸ¥çš„æœ‰ä¸¤ç§æä¾›æœåŠ¡çš„æ–¹å¼ï¼š\næœ¬åœ°ä½¿ç”¨å‘½ä»¤è¡Œæä¾›æœåŠ¡ é¦–å…ˆä½¿ç”¨bentoml serve {bentoname:version} CLIå‘½ä»¤æ¥è¿è¡Œå®ƒï¼Œå¾—åˆ°ä¸€ä¸ªbentoserverï¼š\næ­¤æ—¶æˆ‘ä»¬å‘localhost:3000/{svc.api_name}å‘é€è¯·æ±‚æ—¶ï¼Œæºå¸¦æˆ‘ä»¬éœ€è¦è®©å…¶è¿›è¡Œé¢„æµ‹çš„æ•°æ®ä»¥åŠæ•°æ®ç±»å‹ï¼Œä¾¿å¯ä»¥è·å¾—ç›¸åº”çš„é¢„æµ‹ç»“æœäº†ã€‚\nå°†æ¨¡å‹æ¨é€åˆ°Yataiä¸Šå¹¶éƒ¨ç½² åœ¨bento buildå®Œæˆä¹‹åï¼Œå¯ä»¥å°†æ¨¡å‹pushåˆ°yataiä¸Šï¼Œåœ¨Yataiä¸Šæ ¹æ®æç¤ºéƒ¨ç½²æ¨¡å‹ã€‚è®¾ç½®ç›¸åº”çš„æœåŠ¡å™¨ç«¯å£ä¾¿å¯ä»¥ä½¿ç”¨é¢„æµ‹æœåŠ¡äº†ã€‚\n2ã€è¿›è¡Œé¢„æµ‹ ç›®å‰å·²çŸ¥çš„æœ‰ä¸‰ç§è¿›è¡Œé¢„æµ‹çš„æ–¹å¼ï¼š\nä¸ä½¿ç”¨æœåŠ¡ï¼Œç›´æ¥åŠ è½½æœ¬åœ°ä½¿ç”¨bentoml.{framename}.save_modelæ–¹å¼æ„å»ºå‡ºæ¥çš„æ¨¡å‹ï¼Œå†è¿›è¡Œé¢„æµ‹ï¼ˆç›®å‰ebä½¿ç”¨çš„å°±æ˜¯è¿™ç§æ–¹å¼ import bentoml tensorflow_mnist_runner = bentoml.tensorflow.get(\u0026#34;tensorflow_mnist:latest\u0026#34;).to_runner() tensorflow_mnist_runner.init_local() tensorflow_mnist_runner.run(image) ä½¿ç”¨æœåŠ¡ï¼Œå‘é€è¯·æ±‚ï¼Œé€šè¿‡æœåŠ¡è¿›è¡Œé¢„æµ‹ä»è€Œè·å–ç»“æœ import requests requests_url = \u0026#34;http://127.0.0.1:3000/predict_image\u0026#34; def predict(img_url, request_url): # è·å–äºŒè¿›åˆ¶çš„url with open(img_url, \u0026#39;rb\u0026#39;) as f: img_bytes = f.read() # å‘åˆ›å»ºçš„æœåŠ¡å‘é€é¢„æµ‹è¯·æ±‚ åŒ…å« è¯·æ±‚åœ°å€ã€è¯·æ±‚å¤´ï¼ˆå†…å®¹ç±»å‹ï¼‰ã€ä»¥åŠé¢„æµ‹çš„æ•°æ® result = requests.post( \u0026#34;http://127.0.0.1:3000/predict_image\u0026#34;, headers={\u0026#34;content-type\u0026#34;: \u0026#34;image/png\u0026#34;}, data=img_bytes, ).text # å°†é¢„æµ‹ç»“æœè½¬åŒ–ä¸ºå¯¹åº”æ ‡ç­¾ result = eval(result)[0] max_value = max(result) max_index = result.index(max_value) # è¿”å›é¢„æµ‹å‡ºæ¥çš„æ ‡ç­¾ return max_index results = [] for i in range(10): result = predict(f\u0026#39;./samples/{i}.png\u0026#39;, requests_url) results.append(result) print(results) \u0026gt;\u0026gt; output:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9] ä½¿ç”¨Swagger UIï¼Œäº¤äº’å¼çš„å‘é€é¢„æµ‹è¯·æ±‚ ç‚¹å‡»Try it out:\né€‰æ‹©å›¾ç‰‡å‘é€è¯·æ±‚ï¼š\næŸ¥çœ‹è¿”å›ç»“æœï¼š\näº”ã€Swagger UI åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š\nåœ¨æ„å»ºBentoçš„æ—¶å€™åœ¨bento_name/version/apis/æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†openapi.yamlæ–‡ä»¶ï¼Œç”Ÿæˆçš„openapi.yamlæ–‡ä»¶å®ƒéµå¾ªä»¥ä¸‹è§„èŒƒã€‚ å½“ä½¿ç”¨bentoml serveåœ¨æœ¬åœ°å¯åŠ¨äº†BentoMLæœåŠ¡æˆ–è€…åœ¨Yataiä¸Šéƒ¨ç½²åï¼Œå®ƒä¾¿ä¼šå°†openapi.yamlæ–‡æ¡£è‡ªåŠ¨æä¾›ç»™Swagger UIï¼Œä½¿å…¶å¯ä»¥åœ¨å‰ç«¯æ¸²æŸ“ã€‚ å…¶ä¸­çš„docs.jsonæ˜¯ç”±Swagger UIä»BentoMLæœåŠ¡çš„OpenAPIè§„èŒƒæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆçš„ã€‚ Swagger UI ä¸­è‡ªåŠ¨ç”Ÿæˆçš„å†…å®¹\nsrc/bentoml/_internal/service/openapi/__init__.py\nopenapi.yamlæ–‡ä»¶ç”Ÿæˆçš„ä»£ç è·¯å¾„\nsrc/bentoml/_internal/bento/bento.py\nåŸºäº__init__.pyä¸­çš„å‡½æ•°openapi_specæ„å»º\nå®šä¹‰äº†æœåŠ¡ä¸Šä¼ å¤šä¸ªæ–‡ä»¶è¾“å…¥/è¾“å‡ºçš„ API è§„èŒƒ\nsrc/bentoml/_internal/io_descriptors/multipart.py\nå®šä¹‰ç«¯ç‚¹å’Œå‰ç«¯å†…å®¹\nsrc/bentoml/_internal/server/http_app.py\n","permalink":"https://blog.nyaashino.com/post/bentoml_quickstart/","summary":"BentoML åŸºæœ¬æµç¨‹ï¼š\ntrain.pyè®­ç»ƒæ¨¡å‹ ä½¿ç”¨bentomlä¿å­˜æ¨¡å‹ æ„å»ºservice.pyï¼Œåˆ›å»ºç›¸åº”çš„æœåŠ¡ åˆ›å»ºbentofile.yamlæ–‡ä»¶ ä½¿ç”¨å‘½ä»¤è¡Œbentoml build æ„å»ºBento å°†æ„å»ºå¥½çš„Bentoæ¨é€åˆ°Yataiä¸Šéƒ¨ç½² / åœ¨æœ¬åœ°ä½¿ç”¨å‘½ä»¤å¯åŠ¨æœåŠ¡ å‘é€é¢„æµ‹è¯·æ±‚ ä¸€ã€ä½¿ç”¨BentoMLä¿å­˜æ¨¡å‹ å¦‚æœæƒ³è¦å¼€å§‹ä½¿ç”¨BentoMLæœåŠ¡ï¼Œé¦–å…ˆéœ€è¦å°†è®­ç»ƒçš„æ¨¡å‹ä½¿ç”¨BentoMLçš„APIåœ¨æœ¬åœ°è¿›è¡Œä¿å­˜ã€‚\nbentoml.(framename).save_model(modelname, model)\nframenameå–å†³äºä½ æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ä½¿ç”¨çš„æ¡†æ¶ã€‚\nmodelnameä¸ºæ¨¡å‹ä¿å­˜åçš„åå­—ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬å­—æ®µï¼Œç”¨äºæ£€ç´¢æ¨¡å‹ã€‚\nmodelä¸ºä½ æ‰€æ„å»ºçš„æ¨¡å‹çš„å˜é‡å\nå‡å¦‚æˆ‘æ­¤å‰å·²ç»å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼š\nmnist_clf = 'tensorflow_mnist'\nmnist_model = tf.keras.models.load_model('models/mnist_model.h5')\né‚£ä¹ˆæœ‰ä»¥ä¸‹ä¿å­˜æ¨¡å‹çš„ä¾‹å­ï¼š\nbentoml.tensorflow.save_model(mnist_clf, mnist_model)\ne.g. åŸºäºsklearnå®ç°çš„irisæ•°æ®é›†æ¨¡å‹ï¼š\nimport bentoml from sklearn import svm from sklearn import datasets # Load training data set iris = datasets.load_iris() X, y = iris.data, iris.target # Train the model clf = svm.SVC(gamma=\u0026#39;scale\u0026#39;) clf.fit(X, y) # Save model to the BentoML local model store saved_model = bentoml.","title":"BentoMLä½¿ç”¨æµç¨‹"}]